<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>&lt;at-form-lookup&gt;</title>
  <script src="../webcomponentsjs/webcomponents.js"></script>
  <link rel="import" href="at-form-lookup.html">
</head>
<body>
  <div>
    Tags demo:
    <at-form-lookup id="tagsLookup" available="neat,awesome"></at-form-lookup>
  </div>
  <div>
    Dropdown demo:
    <at-form-lookup id="ddLookup" available="neat,awesome,peka,mika,zika" usedropdown></at-form-lookup>
  </div>
  <div>
    Dropdown demo (programatical initialization):
    <at-form-lookup id="ddLookupProg" usedropdown></at-form-lookup>
  </div>
  <div>
    Tags demo (remote source):
    <at-form-lookup id="flTagsRemote" url="http://gdata.youtube.com/feeds/api/videos/" params='{"alt":"json", "q":""}'></at-form-lookup>

  </div>
  <div>
    Dropdown demo (remote source):
    <at-form-lookup id="flDropdownRemote" usedropdown url="http://gdata.youtube.com/feeds/api/videos/" params='{"alt":"json", "q":"chrome"}'></at-form-lookup>
  </div>

  <script>
    window.addEventListener('polymer-ready', function () {
      console.log('Polymer ready event');
      var demoLookup = document.getElementById("demoLookup");

      var ddLookupProg = document.getElementById("ddLookupProg");
      ddLookupProg.available = JSON.parse('[{"caption": "Pera", "value": "v1"},{"caption": "Mika", "value": "v2"},{ "caption": "Zika", "value": "v3"}]');
      ddLookupProg.selected = "v1";

      var flDropdownRemote = document.getElementById('flDropdownRemote');
      flDropdownRemote.addEventListener('at-form-lookup-beforeAjax', function (event) {
        var data = event.detail;
        data.coreAjax.params = '{"alt":"json", "q":"' + data.query + '"}';
      });

      flDropdownRemote.addEventListener('at-form-lookup-afterAjax', function (event) {
        var data = event.detail.response.feed.entry;
        var dataArray = [];
        for (var i = 0; i < data.length; i++) {
          var entry = data[i];
          dataArray.push({ value: entry.id.$t, text: entry.title.$t });
        }
        event.detail.returnData = dataArray;
      });

    });
  </script>
</body>
</html>
